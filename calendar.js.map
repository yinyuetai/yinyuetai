{"version":3,"sources":["webpack:///./app/src/calendar.js","webpack:///./app/stylesheets/calendar.scss","webpack:///./app/src/views/calendar/main.view.js","webpack:///./app/src/views/calendar/item.view.js","webpack:///./app/src/module/tools/data.js","webpack:///./app/src/models/calendar/item.model.js","webpack:///./app/src/views/calendar/template/Item.html"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;;;;;;;ACTD,0C;;;;;;;ACAA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,EAAC;;AAED;;;;;;;;AClCA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,iBAAiB;AAC3C,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,kBAAiB;AACjB;AACA;AACA,cAAa;AACb;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;;AAEA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,iBAAiB;AACnD,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,EAAC;;AAED;;;;;;;;AC1IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;;;;;;;ACjDA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,WAAU,YAAY;AACtB;AACA;AACA,cAAa,IAAI,eAAe,IAAI;AACpC,sCAAqC,YAAY;AACjD;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;AC9BA,qBAAoB,sBAAsB,mHAAmH,WAAW,oEAAoE,uBAAuB,kEAAkE,aAAa,iFAAiF,aAAa,aAAa,wBAAwB,gBAAgB,gBAAgB,8BAA8B,4BAA4B,yFAAyF,MAAM,4DAA4D,KAAK,iGAAiG,aAAa,aAAa,wBAAwB,yBAAyB,eAAe,4CAA4C,kBAAkB,8NAA8N,OAAO,0BAA0B,OAAO,K","file":"calendar.js","sourcesContent":["/**\r\n * Created by caoxifeng on 16/4/11.\r\n */\r\nvar $ = require('jquery');\r\nrequire('../stylesheets/calendar.scss');\r\nvar MainView = require('./views/calendar/main.view.js');\r\n$(function () {\r\n    // 入口视图\r\n    var mainView = new MainView();\r\n});\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./app/src/calendar.js\n ** module id = 0\n ** module chunks = 0\n **/","// removed by extract-text-webpack-plugin\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./app/stylesheets/calendar.scss\n ** module id = 2\n ** module chunks = 0\n **/","'use strict';\r\n\r\nvar base = require('base-extend-backbone');\r\nvar BaseView = base.View;\r\nvar ItemView = require('./item.view.js');\r\nvar topbar = require('../../module/topbar/topbar.js');\r\n\r\nvar View = BaseView.extend({\r\n    el: '',\r\n    rawLoader: function() {\r\n        return '';\r\n    },\r\n    context: function(args) {\r\n        console.log(args);\r\n    },\r\n    beforeMount: function() {\r\n        //  初始化一些自定义属性\r\n    },\r\n    afterMount: function() {\r\n        //  获取findDOMNode DOM Node\r\n    },\r\n    ready: function() {\r\n        //  初始化\r\n        var itemView = new ItemView();\r\n        new topbar();\r\n    },\r\n    beforeDestroy: function() {\r\n        //  进入销毁之前,将引用关系设置为null\r\n    },\r\n    destroyed: function() {\r\n        //  销毁之后\r\n    }\r\n});\r\n\r\nmodule.exports = View;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./app/src/views/calendar/main.view.js\n ** module id = 23\n ** module chunks = 0\n **/","'use strict';\r\n\r\nvar base = require('base-extend-backbone');\r\nvar BaseView = base.View;\r\n\r\nvar Config = require('config');\r\nvar toolsDate = require('../../module/tools/data.js');\r\nvar env = Config.env[Config.scheme];\r\nvar ItemModel = require('../../models/calendar/item.model.js');\r\nvar View = BaseView.extend({\r\n    el: '.program-list',\r\n    rawLoader: function() {\r\n        return '';\r\n    },\r\n    context: function(args) {\r\n    },\r\n    beforeMount: function() {\r\n        //  初始化一些自定义属性\r\n        this.calendarDataList = [];\r\n        this.dataIndex = 0;\r\n        this.nowTime = '今日';\r\n        this.bScoll = true;\r\n    },\r\n    afterMount: function() {\r\n        //  获取findDOMNode DOM Node\r\n        this.calendarItemTpl = require('./template/Item.html');\r\n    },\r\n    ready: function() {\r\n        //  初始化\r\n        var self = this;\r\n        this.itemModel = new ItemModel();\r\n        var promise1 = this.itemModel.executeJSONP({\r\n            order: 'FOLLOW',\r\n            offset: 0,\r\n            size: 9,\r\n            deviceinfo: '{\"aid\":\"30001001\"}',\r\n        });\r\n        promise1.done(function(res) {\r\n            self.serializelist();\r\n        });\r\n        promise1.fail(function(res) {\r\n            console.log(res);\r\n        });\r\n        this._events();\r\n    },\r\n    serializelist: function() {\r\n        var self = this;\r\n        if (this.itemModel.get('msg') == 'SUCCESS') {\r\n            var data = this.itemModel.get('data');\r\n            if (data.size < 9) {\r\n                this.BScroll = false;\r\n            }\r\n            $.each(data.schedules, function(index, val) {\r\n                var date = new Date();\r\n                var today = date.format('d');\r\n                date.setTime(val.onAirTime);\r\n                val.T_onAirtime = date.formatdate();\r\n                var onAirDay = date.format('d');\r\n                var d = date.format('M') + '.' + onAirDay;\r\n                if (today == onAirDay) {\r\n                    self.nowTime = onAirDay;\r\n                    if (!self.calendarDataList[0]) {\r\n                        self.calendarDataList[0] = {\r\n                            title: '今日',\r\n                            list: [val]\r\n                        };\r\n                    } else {\r\n                        self.calendarDataList[0].list.push(val);\r\n                    }\r\n                } else if (onAirDay != self.nowTime) {\r\n                    if(self.calendarDataList[0]!=undefined){\r\n                        self.dataIndex++;\r\n                    }\r\n                    self.nowTime = onAirDay;\r\n                    self.calendarDataList[self.dataIndex] = {\r\n                        title: d,\r\n                        list: [val]\r\n                    };\r\n\r\n                } else {\r\n                    self.calendarDataList[self.dataIndex].list.push(val);\r\n                }\r\n            });\r\n            this.render();\r\n        }\r\n    },\r\n    render: function() {\r\n        console.log(this.calendarDataList);\r\n        if(this.calendarDataList[0]==undefined){\r\n            this.dataIndex--;\r\n            this.calendarDataList.shift();\r\n        }\r\n        var calendarHtml = this.compileHTML(this.calendarItemTpl, {\r\n            dateList: this.calendarDataList\r\n        });\r\n        this.$el.html(calendarHtml);\r\n\r\n    },\r\n    _events: function() {\r\n        var self = this;\r\n        var i = 0;\r\n        function load() {\r\n            if (!self.bScoll) return;\r\n            var $windowScrollTop = $(window).scrollTop();\r\n            var $windowHeight = $(window).height();\r\n            var $documentHeight = $(document).height();\r\n            if (($windowScrollTop + $windowHeight) == $documentHeight) {\r\n                i++;\r\n                var promise1 = self.itemModel.executeJSONP({\r\n                    order: 'FOLLOW',\r\n                    offset: i * 9,\r\n                    size: 9,\r\n                    deviceinfo: '{\"aid\":\"30001001\"}',\r\n                });\r\n                promise1.done(function(res) {\r\n                    if(res.code==0&&res.data.schedules.length==0){\r\n                        self.bScoll=false;\r\n                    }\r\n                    self.serializelist();\r\n                });\r\n                promise1.fail(function(res) {\r\n                    console.log(res);\r\n                });\r\n                $(window).scrollTop($documentHeight);\r\n            }\r\n        }\r\n        $(window).on('scroll', function() {\r\n            load();\r\n        });\r\n    },\r\n    beforeDestroy: function() {\r\n        //  进入销毁之前,将引用关系设置为null\r\n    },\r\n    destroyed: function() {\r\n        //  销毁之后\r\n    }\r\n});\r\n\r\nmodule.exports = View;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./app/src/views/calendar/item.view.js\n ** module id = 37\n ** module chunks = 0\n **/","/*\r\n日期格式化\r\n*/\r\nDate.prototype.format = function(format) {\r\n    var o = {\r\n        \"M+\": this.getMonth() + 1,\r\n        \"d+\": this.getDate(),\r\n        \"h+\": this.getHours(),\r\n        \"m+\": this.getMinutes(),\r\n        \"s+\": this.getSeconds(),\r\n        \"q+\": Math.floor((this.getMonth() + 3) / 3),\r\n        \"S\": this.getMilliseconds()\r\n    };\r\n\r\n    if (/(y+)/.test(format)) {\r\n        format = format.replace(RegExp.$1, (this.getFullYear() + \"\").substr(4 - RegExp.$1.length));\r\n    }\r\n\r\n    for (var k in o) {\r\n        if (new RegExp(\"(\" + k + \")\").test(format)) {\r\n            format = format.replace(RegExp.$1, RegExp.$1.length == 1 ? o[k] : (\"00\" + o[k]).substr((\"\" + o[k]).length));\r\n        }\r\n    }\r\n    return format;\r\n};\r\n/*\r\n获取序列化时间\r\n*/\r\nfunction toD(n) {\r\n    return n >= 10 ? '' + n : '0' + n;\r\n}\r\nDate.prototype.formatdate = function(format) {\r\n    Y = this.getFullYear();\r\n    M = this.getMonth() + 1;\r\n    D = this.getDate();\r\n    h = this.getHours();\r\n    s = this.getMinutes();\r\n    return Y + '年' + toD(M) + '月' + toD(D) + '日 ' + toD(h) + ':' + toD(s);\r\n};\r\nmodule.exports = {\r\n    sec2time: function(sec) {\r\n        if (sec == 'undefined') {\r\n            return '00:00';\r\n        }\r\n        var h = parseInt(sec / 3600);\r\n        var m = parseInt((sec - h * 3600) / 60);\r\n        var s = parseInt(sec - h * 3600 - m * 60);\r\n        return h > 0 ? h + ':' + toD(m) + ':' + toD(s) : toD(m) + ':' + toD(s);\r\n    },\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./app/src/module/tools/data.js\n ** module id = 39\n ** module chunks = 0 1\n **/","'use strict';\r\n\r\nvar base = require('base-extend-backbone');\r\nvar Config = require('config');\r\nvar BaseModel = base.Model;\r\nvar env = Config.env[Config.scheme];\r\n\r\nvar Model = BaseModel.extend({\r\n  url: '{{url_prefix}}/upcoming/list.json',\r\n  beforeEmit: function beforeEmit() {\r\n    // 给请求地址替换一下环境变量\r\n    if (/^\\{{0,2}(url_prefix)\\}{0,2}/.test(this.url)) {\r\n      this.url = this.url.replace('{{url_prefix}}', env.url_prefix);\r\n    }\r\n  },\r\n  // formatter : function (response) {\r\n  //   response.test = 1;\r\n  //   console.log(response);\r\n  //   return response;\r\n  // }\r\n});\r\n\r\nvar shared = null;\r\nModel.sharedInstanceModel = function sharedInstanceModel() {\r\n  if (!shared) {\r\n    shared = new Model();\r\n  }\r\n  return shared;\r\n};\r\n\r\nmodule.exports = Model;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./app/src/models/calendar/item.model.js\n ** module id = 40\n ** module chunks = 0\n **/","module.exports = \"{{each dateList as val}}\\r\\n<dd class=\\\"program\\\">\\r\\n\\t<div class=\\\"date\\\">\\r\\n\\t\\t<div class=\\\"dot\\\"></div>\\r\\n\\t\\t<div class=\\\"time\\\">{{val.title}}</div>\\r\\n\\t</div>\\r\\n\\t<ul class=\\\"program-oneday-list\\\">\\r\\n\\t\\t{{each val.list as info}}\\r\\n\\t\\t<li class=\\\"program-oneday-li clearfix\\\" data-videoid=\\\"{{info.liveId}}\\\">\\r\\n\\t\\t\\t<div class=\\\"videoBox\\\">\\r\\n\\t\\t\\t\\t<a href=\\\"living.html?videoId={{info.liveId}}&channelId={{info.channel.channelId}}\\\"><img src=\\\"{{info.posterPic}}\\\" alt=\\\"\\\"></a>\\r\\n\\t\\t\\t\\t{{if info.liveType===\\\"VOD\\\"}}\\r\\n\\t\\t\\t\\t\\t<!-- <span class=\\\"palytime\\\"><%=info.T_palytime%></span> -->\\r\\n\\t\\t\\t\\t{{else}}\\r\\n\\t\\t\\t\\t\\t<span class=\\\"live-ico\\\"></span>\\r\\n\\t\\t\\t\\t{{/if}}\\r\\n\\t\\t\\t</div>\\r\\n\\t\\t\\t<div class=\\\"program-msg\\\">\\r\\n\\t\\t\\t\\t<a href=\\\"living.html?videoId={{info.liveId}}&channelId={{info.channel.channelId}}\\\"><h4 class=\\\"title\\\">{{info.liveName}}</h4></a>\\r\\n\\t\\t\\t\\t<span class=\\\"time\\\">{{info.T_onAirtime}}</span>\\r\\n\\t\\t\\t</div>\\r\\n\\t\\t\\t<!-- <div class=\\\"tips\\\"></div>\\r\\n\\t\\t\\t<div class=\\\"clickBox\\\">\\r\\n\\t\\t\\t\\t<div class=\\\"shadow\\\"></div>\\r\\n\\t\\t\\t\\t<div class=\\\"erweima\\\"></div>\\r\\n\\t\\t\\t</div> -->\\r\\n\\t\\t</li>\\r\\n\\t\\t{{/each}}\\r\\n\\t</ul>\\r\\n</dd>\\r\\n{{/each}}\\r\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./app/src/views/calendar/template/Item.html\n ** module id = 41\n ** module chunks = 0\n **/"],"sourceRoot":""}